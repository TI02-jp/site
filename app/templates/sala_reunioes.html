{% extends "base.html" %}

{% block title %}SALA DE REUNIÕES{% endblock %}

{% block sidebar_nav %}
<div class="nav-section">
    <div class="nav-section-title">PRINCIPAL</div>
    <ul class="nav flex-column">
        <li class="nav-item">
            <a class="nav-link" href="{{ url_for('dashboard') }}">
                <i class="bi bi-list-task"></i>
                PARTICULARIDADES
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://app.acessorias.com/sysmain.php" target="_blank" rel="noopener">
                <i class="bi bi-box-arrow-up-right"></i>
                ACESSÓRIAS
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://auth.sieg.com/login" target="_blank" rel="noopener">
                <i class="bi bi-box-arrow-up-right"></i>
                SIEG
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{ url_for('consultorias') }}">
                <i class="bi bi-buildings"></i>
                CONSULTORIAS
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="{{ url_for('sala_reunioes') }}">
                <i class="bi bi-calendar-event"></i>
                SALA DE REUNIÕES
            </a>
        </li>
    </ul>
</div>
<style>
    .content-breadcrumb { display: none; }
</style>
{% endblock %}

{% block content %}
<header class="py-5 text-white text-center" style="background-color: var(--primary);">
    <h1 class="display-4 mb-0"><i class="bi bi-calendar-event me-3"></i>AGENDA DA SALA DE REUNIÕES</h1>
</header>
<div class="container my-4">
    <p class="text-muted">Aqui você poderá consultar a agenda da sala de reuniões.</p>
    <table class="table table-bordered" id="agenda">
        <thead>
            <tr>
                <th>Data</th>
                <th>Período</th>
                <th>Evento</th>
                <th>Usuário</th>
            </tr>
        </thead>
        <tbody>
            {% for item in agenda %}
            <tr data-end="{{ item.data_iso }}T{{ item.fim }}">
                <td>{{ item.data }}</td>
                <td>{{ item.inicio }} - {{ item.fim }}</td>
                <td>{{ item.evento }}</td>
                <td>{{ item.usuario }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center text-muted">Nenhuma reunião agendada.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
function hidePastEvents() {
    const rows = document.querySelectorAll('#agenda tbody tr[data-end]');
    const now = new Date();
    rows.forEach(row => {
        const endTime = new Date(row.dataset.end);
        if (now - endTime > 5 * 60 * 1000) {
            row.style.display = 'none';
        }
    });
}
hidePastEvents();
setInterval(hidePastEvents, 60000);
</script>
{% endblock %}

